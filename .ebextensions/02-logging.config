files:
  "/etc/php.d/elasticbeanstalk.ini":
    mode: "000644"
    owner: root
    group: root
    content: |
      ; AWS Elastic Beanstalk PHP Configuration
      error_reporting = E_ALL & ~E_DEPRECATED & ~E_STRICT
      display_errors = Off
      log_errors = On
      error_log = /var/log/php-error.log
      
      ; Database and application settings
      register_globals = Off
      magic_quotes_gpc = Off
      session.auto_start = Off
      session.cache_limiter = private
      
      ; Performance settings
      max_execution_time = 30
      max_input_time = 60
      memory_limit = 256M
      upload_max_filesize = 10M
      post_max_size = 10M
      
      ; CloudWatch integration
      extension = cloudwatch.so

commands:
  01_log_rotation:
    command: |
      cat > /etc/logrotate.d/elasticbeanstalk-php <<'EOF'
      /var/log/php-error.log {
        daily
        missingok
        rotate 7
        compress
        delaycompress
        notifempty
        create 0644 root root
      }
      EOF
